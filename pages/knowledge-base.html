<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knowledge Base - CVD</title>
    <link rel="stylesheet" href="/css/design-system.css">
    <style>
        /* Import design system if not already included */
        @import url('/css/design-system.css');
        /* Knowledge Base specific styles */
        body {
            margin: 0;
            padding: 0;
            font-family: var(--font-sans);
            background: linear-gradient(to bottom, var(--color-neutral-50) 0%, var(--color-neutral-0) 50%);
            line-height: var(--leading-normal);
        }
        
        .kb-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: var(--space-sm);
            min-height: 100vh;
        }
        
        /* Header Section */
        .kb-header {
            text-align: center;
            margin-bottom: var(--space-lg);
            padding: var(--space-lg) var(--space-md);
            background: linear-gradient(135deg, var(--color-neutral-0) 0%, var(--color-primary-50) 100%);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
        }
        
        .kb-header h1 {
            color: var(--color-neutral-900);
            margin: 0 0 var(--space-sm) 0;
            font-size: var(--text-4xl);
            font-weight: var(--font-semibold);
            line-height: var(--leading-tight);
        }
        
        .kb-header p {
            color: var(--color-neutral-700);
            font-size: var(--text-lg);
            line-height: var(--leading-relaxed);
            margin: 0 auto var(--space-lg) auto;
            max-width: 600px;
        }
        
        /* Search Section - Integrated into Header */
        .kb-search-section {
            background: transparent;
            border-radius: 0;
            padding: 0;
            margin-bottom: 0;
            box-shadow: none;
        }
        
        .kb-search-container {
            position: relative;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .kb-search-input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }
        
        .kb-search-icon {
            position: absolute;
            left: var(--space-md);
            color: var(--color-neutral-500);
            z-index: 1;
            pointer-events: none;
        }
        
        .kb-search-input {
            width: 100%;
            height: 48px;
            padding: var(--space-sm) var(--space-xxl) var(--space-sm) var(--space-xxl);
            font-size: var(--text-base);
            font-family: var(--font-sans);
            border: var(--border-medium) solid var(--color-neutral-300);
            border-radius: var(--radius-lg);
            background: var(--color-neutral-0);
            transition: all 200ms ease-out;
        }
        
        .kb-search-input:focus {
            outline: none;
            border-color: var(--color-primary-500);
            box-shadow: 0 0 0 3px var(--color-primary-100);
        }
        
        .kb-search-input::placeholder {
            color: var(--color-neutral-500);
        }
        
        .kb-search-clear {
            position: absolute;
            right: var(--space-md);
            background: none;
            border: none;
            color: var(--color-neutral-400);
            cursor: pointer;
            padding: var(--space-xs);
            border-radius: var(--radius-sm);
            transition: color 200ms ease-out;
        }
        
        .kb-search-clear:hover {
            color: var(--color-neutral-600);
        }
        
        .kb-search-autocomplete {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--color-neutral-0);
            border: var(--border-thin) solid var(--color-neutral-200);
            border-top: none;
            border-radius: 0 0 var(--radius-lg) var(--radius-lg);
            box-shadow: var(--shadow-md);
            z-index: var(--z-dropdown);
            max-height: 300px;
            overflow-y: auto;
        }
        
        .kb-autocomplete-item {
            padding: var(--space-sm) var(--space-md);
            cursor: pointer;
            border-bottom: var(--border-thin) solid var(--color-neutral-100);
            transition: background-color 200ms ease-out;
        }
        
        .kb-autocomplete-item:last-child {
            border-bottom: none;
        }
        
        .kb-autocomplete-item:hover,
        .kb-autocomplete-item.selected {
            background: var(--color-neutral-50);
        }
        
        .kb-search-filters {
            display: flex;
            justify-content: center;
            gap: var(--space-md);
            margin-top: var(--space-lg);
            flex-wrap: wrap;
            align-items: center;
        }
        
        .kb-filter-select {
            padding: var(--space-sm) var(--space-md);
            border: var(--border-thin) solid var(--color-neutral-300);
            border-radius: var(--radius-md);
            background: var(--color-neutral-0);
            font-size: var(--text-sm);
            color: var(--color-neutral-700);
            transition: border-color 200ms ease-out;
        }
        
        .kb-filter-select:focus {
            outline: none;
            border-color: var(--color-primary-500);
            box-shadow: 0 0 0 2px var(--color-primary-100);
        }
        
        .kb-filters-clear {
            background: var(--color-neutral-200);
            border: none;
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-md);
            font-size: var(--text-sm);
            color: var(--color-neutral-700);
            cursor: pointer;
            transition: background-color 200ms ease-out;
        }
        
        .kb-filters-clear:hover {
            background: var(--color-neutral-300);
        }
        
        /* Section Titles */
        .kb-section-title {
            font-size: var(--text-2xl);
            font-weight: var(--font-semibold);
            color: var(--color-neutral-900);
            margin: 0 0 var(--space-md) 0;
            line-height: var(--leading-normal);
        }
        
        /* Quick Access Section */
        .kb-quick-access {
            margin-bottom: var(--space-xl);
        }
        
        .kb-quick-access-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: var(--space-md);
            margin-bottom: var(--space-xl);
        }
        
        .kb-quick-access-card {
            display: block;
            text-decoration: none;
            background: var(--color-neutral-0);
            border: var(--border-thin) solid var(--color-neutral-200);
            border-radius: var(--radius-lg);
            padding: var(--space-md);
            transition: all 200ms ease-out;
            text-align: center;
        }
        
        .kb-quick-access-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
            border-color: var(--color-primary-300);
        }
        
        .kb-quick-access-card:focus {
            outline: var(--border-medium) solid var(--color-primary-500);
            outline-offset: 2px;
        }
        
        
        .kb-quick-access-card h3 {
            font-size: var(--text-base);
            font-weight: var(--font-semibold);
            color: var(--color-neutral-900);
            margin: 0 0 var(--space-xs) 0;
        }
        
        .kb-quick-access-card p {
            font-size: var(--text-sm);
            color: var(--color-neutral-600);
            margin: 0;
            line-height: var(--leading-normal);
        }
        
        /* Categories Grid */
        .kb-categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: var(--space-md);
            margin-bottom: var(--space-xl);
        }
        
        .kb-category-card {
            background: var(--color-neutral-0);
            border: var(--border-thin) solid var(--color-neutral-200);
            border-radius: var(--radius-lg);
            padding: var(--space-md);
            transition: all 200ms ease-out;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            display: block;
            text-decoration: none;
            color: inherit;
            height: 100px;
            display: flex;
            flex-direction: column;
        }
        
        .kb-category-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
            border-color: var(--color-primary-300);
        }
        
        .kb-category-card:focus {
            outline: var(--border-medium) solid var(--color-primary-500);
            outline-offset: 2px;
        }
        
        
        .kb-category-title {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--color-neutral-900);
            margin: 0 0 var(--space-xs) 0;
            line-height: var(--leading-normal);
        }
        
        .kb-category-description {
            color: var(--color-neutral-600);
            font-size: var(--text-sm);
            margin: 0 0 auto 0;
            line-height: var(--leading-normal);
            flex-grow: 1;
        }
        
        .kb-category-count {
            background: var(--color-primary-100);
            color: var(--color-primary-700);
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius-full);
            font-size: var(--text-xs);
            font-weight: var(--font-medium);
            align-self: flex-start;
            margin-top: var(--space-sm);
        }
        
        /* Article Highlights */
        .kb-article-highlights {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--space-lg);
            margin-top: var(--space-xl);
        }
        
        .kb-highlight-section {
            background: var(--color-neutral-0);
            border-radius: var(--radius-lg);
            padding: var(--space-md);
            box-shadow: var(--shadow-sm);
        }
        
        .kb-highlight-title {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--color-neutral-800);
            margin: 0 0 var(--space-md) 0;
            line-height: var(--leading-normal);
        }
        
        .kb-highlight-article {
            padding: var(--space-sm) 0;
            border-bottom: var(--border-thin) solid var(--color-neutral-100);
        }
        
        .kb-highlight-article:last-child {
            border-bottom: none;
        }
        
        .kb-highlight-article-link {
            display: block;
            text-decoration: none;
            color: var(--color-primary-500);
            font-weight: var(--font-medium);
            font-size: var(--text-sm);
            line-height: var(--leading-normal);
            transition: color 200ms ease-out;
        }
        
        .kb-highlight-article-link:hover {
            color: var(--color-primary-600);
            text-decoration: underline;
        }
        
        .kb-highlight-article-meta {
            font-size: var(--text-xs);
            color: var(--color-neutral-500);
            margin-top: var(--space-xs);
        }
        
        /* Article List */
        .kb-article-list {
            display: none;
            background: var(--color-neutral-0);
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }
        
        .kb-article-list-header {
            padding: var(--space-lg) var(--space-xl);
            border-bottom: var(--border-thin) solid var(--color-neutral-200);
            background: var(--color-neutral-50);
        }
        
        .kb-breadcrumb {
            font-size: var(--text-sm);
            color: var(--color-neutral-500);
            margin-bottom: var(--space-sm);
            line-height: var(--leading-normal);
        }
        
        .kb-breadcrumb a {
            color: var(--color-primary-600);
            text-decoration: none;
            transition: color 200ms ease-out;
        }
        
        .kb-breadcrumb a:hover {
            color: var(--color-primary-700);
            text-decoration: underline;
        }
        
        .kb-breadcrumb a:focus {
            outline: var(--border-thin) solid var(--color-primary-500);
            outline-offset: 2px;
            border-radius: var(--radius-sm);
        }
        
        .kb-back-button {
            background: var(--color-neutral-200);
            border: none;
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: var(--text-sm);
            color: var(--color-neutral-700);
            font-weight: var(--font-medium);
            margin-bottom: var(--space-md);
            transition: all 200ms ease-out;
            display: inline-flex;
            align-items: center;
            gap: var(--space-xs);
        }
        
        .kb-back-button:hover {
            background: var(--color-neutral-300);
        }
        
        .kb-back-button:focus {
            outline: var(--border-medium) solid var(--color-primary-500);
            outline-offset: 2px;
        }
        
        .kb-article-item {
            padding: var(--space-lg) var(--space-xl);
            border-bottom: var(--border-thin) solid var(--color-neutral-100);
            cursor: pointer;
            transition: background-color 200ms ease-out;
        }
        
        .kb-article-item:last-child {
            border-bottom: none;
        }
        
        .kb-article-item:hover {
            background: var(--color-neutral-50);
        }
        
        .kb-article-item:focus {
            outline: var(--border-medium) solid var(--color-primary-500);
            outline-offset: -2px;
        }
        
        .kb-article-title {
            font-size: var(--text-lg);
            font-weight: var(--font-medium);
            color: var(--color-primary-500);
            margin: 0 0 var(--space-sm) 0;
            line-height: var(--leading-normal);
        }
        
        .kb-article-meta {
            display: flex;
            gap: var(--space-md);
            font-size: var(--text-sm);
            color: var(--color-neutral-500);
            margin-bottom: var(--space-sm);
            flex-wrap: wrap;
            align-items: center;
        }
        
        .kb-article-description {
            color: var(--color-neutral-600);
            font-size: var(--text-sm);
            line-height: var(--leading-normal);
            margin: 0;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .kb-difficulty-badge {
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius-full);
            font-size: var(--text-xs);
            font-weight: var(--font-medium);
            text-transform: capitalize;
        }
        
        .kb-difficulty-beginner {
            background: var(--color-success-bg);
            color: var(--color-success-text);
        }
        
        .kb-difficulty-intermediate {
            background: var(--color-warning-bg);
            color: var(--color-warning-text);
        }
        
        .kb-difficulty-advanced {
            background: var(--color-danger-bg);
            color: var(--color-danger-text);
        }
        
        /* Search Results */
        .kb-search-results {
            display: none;
            background: var(--color-neutral-0);
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }
        
        .kb-search-results-header {
            padding: var(--space-lg) var(--space-xl);
            border-bottom: var(--border-thin) solid var(--color-neutral-200);
            background: var(--color-neutral-50);
        }
        
        .kb-search-result-item {
            padding: var(--space-lg) var(--space-xl);
            border-bottom: var(--border-thin) solid var(--color-neutral-100);
            cursor: pointer;
            transition: background-color 200ms ease-out;
        }
        
        .kb-search-result-item:last-child {
            border-bottom: none;
        }
        
        .kb-search-result-item:hover {
            background: var(--color-neutral-50);
        }
        
        .kb-search-result-item:focus {
            outline: var(--border-medium) solid var(--color-primary-500);
            outline-offset: -2px;
        }
        
        .kb-search-snippet {
            color: var(--color-neutral-600);
            font-size: var(--text-sm);
            line-height: var(--leading-normal);
            margin-top: var(--space-sm);
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .kb-search-snippet mark {
            background: var(--color-warning-bg);
            color: var(--color-warning-text);
            padding: 0 var(--space-xs);
            font-weight: var(--font-semibold);
        }
        
        /* Article Content */
        .kb-article-content {
            display: none;
            background: var(--color-neutral-0);
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }
        
        .kb-article-content-header {
            padding: var(--space-lg) var(--space-xl);
            border-bottom: var(--border-thin) solid var(--color-neutral-200);
            background: var(--color-neutral-50);
        }
        
        .kb-article-metadata {
            background: var(--color-neutral-50);
            border: var(--border-thin) solid var(--color-neutral-200);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            margin: var(--space-lg) 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--space-md);
            font-size: var(--text-sm);
        }
        
        .kb-article-layout {
            display: grid;
            grid-template-columns: 240px 1fr;
            gap: var(--space-xl);
            padding: var(--space-xl);
        }
        
        .kb-article-sidebar {
            position: sticky;
            top: var(--space-lg);
            height: fit-content;
        }
        
        .kb-table-of-contents {
            background: var(--color-neutral-50);
            border: var(--border-thin) solid var(--color-neutral-200);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            margin-bottom: var(--space-lg);
        }
        
        .kb-table-of-contents h4 {
            font-size: var(--text-sm);
            font-weight: var(--font-semibold);
            color: var(--color-neutral-800);
            margin: 0 0 var(--space-sm) 0;
        }
        
        .kb-toc-nav {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .kb-toc-nav a {
            display: block;
            padding: var(--space-xs) 0;
            font-size: var(--text-sm);
            color: var(--color-neutral-600);
            text-decoration: none;
            transition: color 200ms ease-out;
        }
        
        .kb-toc-nav a:hover,
        .kb-toc-nav a.active {
            color: var(--color-primary-600);
        }
        
        .kb-article-actions {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
        }
        
        .kb-print-button {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            background: var(--color-neutral-100);
            border: var(--border-thin) solid var(--color-neutral-300);
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-md);
            font-size: var(--text-sm);
            color: var(--color-neutral-700);
            cursor: pointer;
            transition: all 200ms ease-out;
        }
        
        .kb-print-button:hover {
            background: var(--color-neutral-200);
            border-color: var(--color-neutral-400);
        }
        
        .kb-print-button:focus {
            outline: var(--border-medium) solid var(--color-primary-500);
            outline-offset: 2px;
        }
        
        .kb-article-body {
            max-width: 1000px;
            line-height: var(--leading-relaxed);
        }
        
        .kb-article-body h1,
        .kb-article-body h2,
        .kb-article-body h3,
        .kb-article-body h4 {
            color: var(--color-neutral-900);
            margin-top: var(--space-xl);
            margin-bottom: var(--space-md);
            line-height: var(--leading-tight);
        }
        
        .kb-article-body h1 {
            font-size: var(--text-4xl);
            font-weight: var(--font-semibold);
            border-bottom: var(--border-medium) solid var(--color-primary-200);
            padding-bottom: var(--space-sm);
        }
        
        .kb-article-body h2 {
            font-size: var(--text-2xl);
            font-weight: var(--font-semibold);
        }
        
        .kb-article-body h3 {
            font-size: var(--text-xl);
            font-weight: var(--font-medium);
        }
        
        .kb-article-body h4 {
            font-size: var(--text-lg);
            font-weight: var(--font-medium);
        }
        
        .kb-article-body p {
            color: var(--color-neutral-700);
            margin-bottom: var(--space-md);
        }
        
        .kb-article-body .lead {
            font-size: var(--text-lg);
            color: var(--color-neutral-600);
            font-weight: var(--font-normal);
            margin-bottom: var(--space-lg);
        }
        
        .kb-article-body ul,
        .kb-article-body ol {
            margin-bottom: var(--space-md);
            padding-left: var(--space-lg);
            color: var(--color-neutral-700);
        }
        
        .kb-article-body li {
            margin-bottom: var(--space-sm);
            line-height: var(--leading-normal);
        }
        
        .kb-article-body code {
            background: var(--color-neutral-50);
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius-sm);
            font-family: var(--font-mono);
            font-size: var(--text-sm);
            color: var(--color-neutral-800);
        }
        
        .kb-article-body pre {
            background: var(--color-neutral-50);
            border: var(--border-thin) solid var(--color-neutral-200);
            padding: var(--space-md);
            border-radius: var(--radius-md);
            overflow-x: auto;
            margin-bottom: var(--space-md);
            font-size: var(--text-sm);
        }
        
        .kb-article-body pre code {
            background: none;
            padding: 0;
        }
        
        .kb-article-body blockquote {
            border-left: var(--border-thick) solid var(--color-primary-300);
            padding-left: var(--space-md);
            margin: var(--space-md) 0;
            color: var(--color-neutral-600);
            font-style: italic;
        }
        
        .kb-article-body img {
            max-width: 100%;
            height: auto;
            border-radius: var(--radius-md);
            margin: var(--space-lg) 0;
        }
        
        .kb-article-body table {
            width: 100%;
            border-collapse: collapse;
            margin: var(--space-md) 0;
        }
        
        .kb-article-body th,
        .kb-article-body td {
            padding: var(--space-sm) var(--space-md);
            border: var(--border-thin) solid var(--color-neutral-200);
            text-align: left;
        }
        
        .kb-article-body th {
            background: var(--color-neutral-50);
            font-weight: var(--font-semibold);
            color: var(--color-neutral-800);
        }
        
        .kb-article-footer {
            border-top: var(--border-thin) solid var(--color-neutral-200);
            background: var(--color-neutral-50);
            padding: var(--space-lg) var(--space-xl);
        }
        
        .kb-article-feedback {
            margin-bottom: var(--space-lg);
            text-align: center;
        }
        
        .kb-article-feedback h4 {
            font-size: var(--text-lg);
            font-weight: var(--font-medium);
            color: var(--color-neutral-800);
            margin: 0 0 var(--space-md) 0;
        }
        
        .kb-feedback-buttons {
            display: flex;
            justify-content: center;
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
        }
        
        .kb-feedback-button {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            background: var(--color-neutral-0);
            border: var(--border-thin) solid var(--color-neutral-300);
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            transition: all 200ms ease-out;
            color: var(--color-neutral-700);
        }
        
        .kb-feedback-button:hover {
            border-color: var(--color-primary-300);
            background: var(--color-primary-50);
            color: var(--color-primary-700);
        }
        
        .kb-feedback-button:focus {
            outline: var(--border-medium) solid var(--color-primary-500);
            outline-offset: 2px;
        }
        
        .kb-feedback-button.selected {
            background: var(--color-primary-100);
            border-color: var(--color-primary-500);
            color: var(--color-primary-700);
        }
        
        .kb-feedback-form {
            max-width: 500px;
            margin: 0 auto;
            text-align: left;
        }
        
        .kb-feedback-label {
            display: block;
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--color-neutral-700);
            margin-bottom: var(--space-sm);
        }
        
        .kb-feedback-textarea {
            width: 100%;
            padding: var(--space-sm);
            border: var(--border-thin) solid var(--color-neutral-300);
            border-radius: var(--radius-md);
            font-family: var(--font-sans);
            font-size: var(--text-sm);
            resize: vertical;
            min-height: 80px;
        }
        
        .kb-feedback-textarea:focus {
            outline: none;
            border-color: var(--color-primary-500);
            box-shadow: 0 0 0 2px var(--color-primary-100);
        }
        
        .kb-feedback-actions {
            display: flex;
            gap: var(--space-sm);
            margin-top: var(--space-md);
            justify-content: flex-end;
        }
        
        .kb-feedback-submit {
            background: var(--color-primary-500);
            color: var(--color-neutral-0);
            border: none;
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-md);
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            cursor: pointer;
            transition: background-color 200ms ease-out;
        }
        
        .kb-feedback-submit:hover {
            background: var(--color-primary-600);
        }
        
        .kb-feedback-cancel {
            background: var(--color-neutral-200);
            color: var(--color-neutral-700);
            border: none;
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-md);
            font-size: var(--text-sm);
            cursor: pointer;
            transition: background-color 200ms ease-out;
        }
        
        .kb-feedback-cancel:hover {
            background: var(--color-neutral-300);
        }
        
        .kb-feedback-thanks {
            color: var(--color-success-text);
            font-weight: var(--font-medium);
        }
        
        .kb-article-navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--space-md);
            margin-top: var(--space-lg);
        }
        
        .kb-nav-button {
            background: var(--color-primary-500);
            color: var(--color-neutral-0);
            border: none;
            padding: var(--space-sm) var(--space-lg);
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            transition: background-color 200ms ease-out;
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }
        
        .kb-nav-button:hover {
            background: var(--color-primary-600);
        }
        
        .kb-nav-button:focus {
            outline: var(--border-medium) solid var(--color-primary-200);
            outline-offset: 2px;
        }
        
        .kb-nav-button:disabled {
            background: var(--color-neutral-300);
            cursor: not-allowed;
            color: var(--color-neutral-500);
        }
        
        /* Loading and Error States */
        .kb-loading {
            text-align: center;
            padding: var(--space-xxxl) var(--space-lg);
            color: var(--color-neutral-500);
        }
        
        .kb-loading-spinner {
            width: 32px;
            height: 32px;
            border: 3px solid var(--color-neutral-200);
            border-top: 3px solid var(--color-primary-500);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto var(--space-md);
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .kb-error {
            background: var(--color-danger-bg);
            border: var(--border-thin) solid var(--color-danger-border);
            border-radius: var(--radius-md);
            padding: var(--space-lg);
            margin: var(--space-lg) 0;
            text-align: center;
        }
        
        .kb-error h3 {
            color: var(--color-danger-text);
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            margin: 0 0 var(--space-sm) 0;
        }
        
        .kb-error p {
            color: var(--color-danger-text);
            margin: 0 0 var(--space-md) 0;
        }
        
        .kb-error-retry {
            background: var(--color-danger);
            color: var(--color-neutral-0);
            border: none;
            padding: var(--space-sm) var(--space-lg);
            border-radius: var(--radius-md);
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            cursor: pointer;
            transition: background-color 200ms ease-out;
        }
        
        .kb-error-retry:hover {
            background: var(--color-danger-text);
        }
        
        .kb-empty-state {
            text-align: center;
            padding: var(--space-xxxl) var(--space-lg);
            color: var(--color-neutral-500);
        }
        
        .kb-empty-state h3 {
            margin: var(--space-md) 0 var(--space-sm);
            color: var(--color-neutral-700);
            font-size: var(--text-xl);
            font-weight: var(--font-semibold);
        }
        
        .kb-empty-state p {
            margin: 0;
            font-size: var(--text-base);
        }
        
        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        /* Focus indicators */
        *:focus {
            outline: var(--border-medium) solid var(--color-primary-500);
            outline-offset: 2px;
        }
        
        button:focus,
        input:focus,
        select:focus,
        textarea:focus {
            outline-offset: 0;
        }
        
        /* Responsive Design */
        @media (max-width: 1023px) {
            .kb-article-layout {
                grid-template-columns: 1fr;
                gap: var(--space-lg);
            }
            
            .kb-article-sidebar {
                position: static;
                order: -1;
            }
            
            .kb-table-of-contents {
                margin-bottom: var(--space-md);
            }
        }
        
        @media (max-width: 767px) {
            .kb-container {
                padding: var(--space-xs);
            }
            
            .kb-header {
                padding: var(--space-md) var(--space-sm);
            }
            
            .kb-header h1 {
                font-size: var(--text-3xl);
            }
            
            .kb-article-list-header,
            .kb-article-content-header,
            .kb-article-layout,
            .kb-search-results-header,
            .kb-article-footer {
                padding: var(--space-sm);
            }
            
            .kb-categories-grid {
                grid-template-columns: 1fr;
                gap: var(--space-sm);
            }
            
            .kb-quick-access-grid {
                grid-template-columns: 1fr;
                gap: var(--space-sm);
            }
            
            .kb-search-filters {
                flex-direction: column;
                align-items: stretch;
                gap: var(--space-sm);
            }
            
            .kb-article-metadata {
                grid-template-columns: 1fr;
            }
            
            .kb-article-highlights {
                grid-template-columns: 1fr;
                gap: var(--space-lg);
            }
            
            .kb-article-navigation {
                flex-direction: column;
                gap: var(--space-sm);
            }
            
            .kb-feedback-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .kb-feedback-actions {
                flex-direction: column;
                align-items: stretch;
            }
            
            .kb-article-meta {
                flex-direction: column;
                gap: var(--space-sm);
                align-items: flex-start;
            }
        }
        
        @media (max-width: 479px) {
            .kb-container {
                padding: var(--space-sm);
            }
            
            .kb-search-input {
                font-size: 16px; /* Prevent zoom on iOS */
            }
        }
        
        /* Print styles */
        @media print {
            .kb-search-section,
            .kb-article-sidebar,
            .kb-article-footer,
            .kb-back-button,
            .kb-loading,
            .kb-error {
                display: none !important;
            }
            
            .kb-article-content {
                box-shadow: none;
                border-radius: 0;
            }
            
            .kb-article-body {
                max-width: none;
            }
            
            .kb-article-layout {
                grid-template-columns: 1fr;
                padding: 0;
            }
        }
    </style>
    <!-- Add missing CSS variables if design system is incomplete -->
    <style>
        :root {
            --duration-fast: 200ms;
            --ease-out: cubic-bezier(0.25, 0.46, 0.45, 0.94);
            /* Error color variants if missing */
            --color-error-50: #fef2f2;
            --color-error-100: #fee2e2;
            --color-error-200: #fecaca;
            --color-success-100: #dcfce7;
            --color-success-700: #15803d;
            --color-warning-100: #fef3c7;
            --color-warning-700: #a16207;
            --color-warning-800: #92400e;
        }
    </style>
</head>
<body>
    <div class="kb-container" role="main">
        <!-- Header with Integrated Search -->
        <header class="kb-header" role="banner">
            <h1>CVD Knowledge Base</h1>
            <p>Find answers, tutorials, and guides for CVD vending machine fleet management. Search our comprehensive documentation or browse by category to get the help you need.</p>
            
            <!-- Integrated Search Section -->
            <section class="kb-search-section" role="search" aria-label="Knowledge base search">
            <div class="kb-search-container">
                <div class="kb-search-input-wrapper">
                    <svg class="kb-search-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                        <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"/>
                    </svg>
                    <input type="text" class="kb-search-input" id="searchInput" 
                           placeholder="Search articles, guides, and troubleshooting..."
                           autocomplete="off"
                           role="searchbox"
                           aria-label="Search knowledge base"
                           aria-describedby="search-instructions">
                    <button class="kb-search-clear" id="searchClear" type="button" aria-label="Clear search" style="display: none;">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true">
                            <path d="M.293.293a1 1 0 011.414 0L8 6.586 14.293.293a1 1 0 111.414 1.414L9.414 8l6.293 6.293a1 1 0 01-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 01-1.414-1.414L6.586 8 .293 1.707a1 1 0 010-1.414z"/>
                        </svg>
                    </button>
                </div>
                <div class="kb-search-autocomplete" id="searchAutocomplete" style="display: none;" role="listbox" aria-label="Search suggestions"></div>
            </div>
            <div class="kb-search-filters" id="searchFilters" style="display: none;" role="group" aria-label="Search filters">
                <select class="kb-filter-select" id="categoryFilter" aria-label="Filter by category">
                    <option value="">All Categories</option>
                </select>
                <select class="kb-filter-select" id="difficultyFilter" aria-label="Filter by difficulty level">
                    <option value="">All Levels</option>
                    <option value="Beginner">Beginner</option>
                    <option value="Intermediate">Intermediate</option>
                    <option value="Advanced">Advanced</option>
                </select>
                <button class="kb-filters-clear" id="filtersClear" type="button" style="display: none;">Clear Filters</button>
            </div>
            <p id="search-instructions" class="sr-only">Type to search articles, use filters to narrow results. Press Enter or click suggestions to search.</p>
            </section>
        </header>

        <!-- Quick Access Section -->
        <section class="kb-quick-access" id="quickAccess" aria-label="Quick access to popular content">
            <h2 class="kb-section-title">Quick Access</h2>
            <div class="kb-quick-access-grid">
                <a href="#" class="kb-quick-access-card" data-action="getting-started" aria-describedby="getting-started-desc">
                    <h3>Getting Started</h3>
                    <p id="getting-started-desc">New to CVD? Start here for the basics</p>
                </a>
                <a href="#" class="kb-quick-access-card" data-action="common-issues" aria-describedby="common-issues-desc">
                    <h3>Common Issues</h3>
                    <p id="common-issues-desc">Quick solutions to frequent problems</p>
                </a>
                <a href="#" class="kb-quick-access-card" data-action="whats-new" aria-describedby="whats-new-desc">
                    <h3>What's New</h3>
                    <p id="whats-new-desc">Latest features and updates</p>
                </a>
            </div>
        </section>

        <!-- Categories Overview -->
        <section id="categoriesView" aria-label="Browse by category">
            <h2 class="kb-section-title">Browse by Category</h2>
            <div class="kb-categories-grid" id="categoriesGrid" role="list">
                <!-- Categories loaded dynamically -->
            </div>

            <!-- Recent and Popular Articles -->
            <div class="kb-article-highlights">
                <div class="kb-highlight-section">
                    <h3 class="kb-highlight-title">Recent Articles</h3>
                    <div class="kb-recent-articles" id="recentArticles">
                        <!-- Recent articles loaded dynamically -->
                    </div>
                </div>
                <div class="kb-highlight-section">
                    <h3 class="kb-highlight-title">Popular Articles</h3>
                    <div class="kb-popular-articles" id="popularArticles">
                        <!-- Popular articles loaded dynamically -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Search Results -->
        <div class="kb-search-results" id="searchResults">
            <div class="kb-search-results-header">
                <div class="kb-breadcrumb">
                    <a href="#" onclick="showCategoriesView()">Knowledge Base</a> → Search Results
                </div>
                <button class="kb-back-button" onclick="showCategoriesView()">← Back to Categories</button>
                <h2 id="searchResultsTitle">Search Results</h2>
            </div>
            <div id="searchResultsList"></div>
        </div>

        <!-- Article List View -->
        <div class="kb-article-list" id="articleListView">
            <div class="kb-article-list-header">
                <div class="kb-breadcrumb" id="breadcrumb"></div>
                <button class="kb-back-button" id="backButton" onclick="showCategoriesView()">← Back to Categories</button>
                <h2 id="categoryTitle"></h2>
            </div>
            <div id="articlesList"></div>
        </div>

        <!-- Article Content View -->
        <article class="kb-article-content" id="articleView" role="main">
            <header class="kb-article-content-header">
                <nav class="kb-breadcrumb" id="articleBreadcrumb" aria-label="Article breadcrumb"></nav>
                <button class="kb-back-button" id="articleBackButton" aria-label="Go back to article list">← Back to Articles</button>
                <div class="kb-article-metadata" id="articleMetadata"></div>
            </header>
            <div class="kb-article-layout">
                <aside class="kb-article-sidebar" id="articleSidebar">
                    <div class="kb-table-of-contents" id="tableOfContents" style="display: none;">
                        <h4>Table of Contents</h4>
                        <nav class="kb-toc-nav" role="navigation" aria-label="Article table of contents">
                            <!-- Table of contents generated dynamically -->
                        </nav>
                    </div>
                    <div class="kb-article-actions">
                        <button class="kb-print-button" id="printButton" type="button" aria-label="Print this article">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true">
                                <path d="M4 2V1a1 1 0 011-1h6a1 1 0 011 1v1h2a2 2 0 012 2v6a2 2 0 01-2 2h-1v2a1 1 0 01-1 1H5a1 1 0 01-1-1v-2H2a2 2 0 01-2-2V4a2 2 0 012-2h2zM5 1v1h6V1H5zm7 3H4a1 1 0 00-1 1v6a1 1 0 001 1h8a1 1 0 001-1V5a1 1 0 00-1-1zM5 13v-2h6v2H5z"/>
                            </svg>
                            Print
                        </button>
                    </div>
                </aside>
                <div class="kb-article-body" id="articleContent"></div>
            </div>
            <footer class="kb-article-footer">
                <div class="kb-article-feedback" id="articleFeedback">
                    <h4>Was this article helpful?</h4>
                    <div class="kb-feedback-buttons" role="group" aria-label="Article feedback">
                        <button class="kb-feedback-button kb-feedback-positive" id="feedbackPositive" type="button" aria-label="This article was helpful">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true">
                                <path d="M2 6.5C2 5.119 3.119 4 4.5 4h1.045c.796 0 1.588.24 2.273.69L8.5 5.25l.682-.56A3.954 3.954 0 0111.455 4H12.5C13.881 4 15 5.119 15 6.5v4c0 1.381-1.119 2.5-2.5 2.5h-1.045a3.954 3.954 0 01-2.273-.69L8.5 11.75l-.682.56A3.954 3.954 0 015.545 13H4.5C3.119 13 2 11.881 2 10.5v-4z"/>
                            </svg>
                            Yes
                        </button>
                        <button class="kb-feedback-button kb-feedback-negative" id="feedbackNegative" type="button" aria-label="This article was not helpful">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true">
                                <path d="M8.5 2.5L8.5 2.5C9.881 2.5 11 3.619 11 5v1c0 .796-.24 1.588-.69 2.273L9.75 8.5l.56.682c.45.685.69 1.477.69 2.273v1c0 1.381-1.119 2.5-2.5 2.5L8.5 15L8.5 15c-1.381 0-2.5-1.119-2.5-2.5v-1c0-.796.24-1.588.69-2.273L7.25 8.5l-.56-.682C6.24 7.133 6 6.341 6 5.545V5c0-1.381 1.119-2.5 2.5-2.5z"/>
                            </svg>
                            No
                        </button>
                    </div>
                    <div class="kb-feedback-form" id="feedbackForm" style="display: none;">
                        <label for="feedbackComment" class="kb-feedback-label">How can we improve this article? (optional)</label>
                        <textarea class="kb-feedback-textarea" id="feedbackComment" placeholder="Your feedback helps us improve..." rows="3" maxlength="500"></textarea>
                        <div class="kb-feedback-actions">
                            <button class="kb-feedback-submit" id="feedbackSubmit" type="button">Submit Feedback</button>
                            <button class="kb-feedback-cancel" id="feedbackCancel" type="button">Cancel</button>
                        </div>
                    </div>
                    <div class="kb-feedback-thanks" id="feedbackThanks" style="display: none;">
                        <p>Thank you for your feedback!</p>
                    </div>
                </div>
                <nav class="kb-article-navigation" id="articleNavigation" aria-label="Article navigation">
                    <button class="kb-nav-button" id="prevArticle" style="display: none;" aria-label="Go to previous article">← Previous Article</button>
                    <button class="kb-nav-button" id="nextArticle" style="display: none;" aria-label="Go to next article">Next Article →</button>
                </nav>
            </footer>
        </article>

        <!-- Loading State -->
        <div class="kb-loading" id="loadingState" style="display: none;" role="status" aria-label="Loading content">
            <div class="kb-loading-spinner" aria-hidden="true"></div>
            <p>Loading knowledge base content...</p>
        </div>

        <!-- Error State -->
        <div class="kb-error" id="errorState" style="display: none;" role="alert">
            <h3>Unable to Load Content</h3>
            <p>We're having trouble loading the knowledge base. Please check your connection and try again.</p>
            <button class="kb-error-retry" onclick="location.reload()" type="button">Try Again</button>
        </div>

        <!-- Screen Reader Only Instructions -->
        <div class="sr-only">
            <h2>Navigation Instructions</h2>
            <p>Use Tab to navigate between elements. Use Enter or Space to activate buttons and links. Use arrow keys to navigate within lists and dropdowns.</p>
        </div>
    </div>

    <!-- Dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/marked@9.1.6/marked.min.js"></script>
    <script src="/api.js"></script>
    <script src="/auth-check.js"></script>
    <script src="/pages/knowledge-base.js"></script>
</body>
</html>
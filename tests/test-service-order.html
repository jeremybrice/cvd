<!DOCTYPE html>
<html>
<head>
    <title>Service Order Debug Test</title>
    <script src="/api.js"></script>
</head>
<body>
    <h1>Service Order Debug Test</h1>
    <button id="test-api">Test API</button>
    <div id="output"></div>
    
    <script>
        // Wait for page to load
        window.addEventListener('DOMContentLoaded', function() {
            const output = document.getElementById('output');
            
            // Test 1: Check if api is available
            output.innerHTML += '<p>Test 1 - API exists: ' + (typeof api !== 'undefined') + '</p>';
            
            // Test 2: Check if CVDApi exists
            output.innerHTML += '<p>Test 2 - CVDApi exists: ' + (typeof CVDApi !== 'undefined') + '</p>';
            
            // Test 3: Create api instance
            try {
                const testApi = new CVDApi();
                output.innerHTML += '<p>Test 3 - Can create CVDApi: true</p>';
                
                // Test 4: Check methods
                output.innerHTML += '<p>Test 4 - Has makeRequest: ' + (typeof testApi.makeRequest === 'function') + '</p>';
                output.innerHTML += '<p>Test 5 - Has post: ' + (typeof testApi.post === 'function') + '</p>';
                
                // Test 5: Check global api
                if (typeof api !== 'undefined') {
                    output.innerHTML += '<p>Test 6 - Global api has makeRequest: ' + (typeof api.makeRequest === 'function') + '</p>';
                    output.innerHTML += '<p>Test 7 - Global api has post: ' + (typeof api.post === 'function') + '</p>';
                }
                
            } catch (error) {
                output.innerHTML += '<p>Test 3 - Error creating CVDApi: ' + error.message + '</p>';
            }
            
            // Button test
            document.getElementById('test-api').addEventListener('click', async function() {
                output.innerHTML += '<hr><p>Button clicked - Testing API call...</p>';
                
                try {
                    if (typeof api !== 'undefined' && typeof api.makeRequest === 'function') {
                        output.innerHTML += '<p>Calling api.makeRequest...</p>';
                        // Don't actually make the call, just test it exists
                        output.innerHTML += '<p>✓ api.makeRequest exists and is callable</p>';
                    } else {
                        output.innerHTML += '<p>✗ api.makeRequest not found</p>';
                    }
                    
                    if (typeof api !== 'undefined' && typeof api.post === 'function') {
                        output.innerHTML += '<p>✓ api.post exists</p>';
                    } else {
                        output.innerHTML += '<p>✗ api.post does not exist (this is expected)</p>';
                    }
                } catch (error) {
                    output.innerHTML += '<p>Error: ' + error.message + '</p>';
                }
            });
        });
    </script>
</body>
</html>